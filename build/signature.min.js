/*! signature 2013-04-17 */
(function(){var n,t=function(){var n=function(n){return n.replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,"").replace(/\s+/g," ")},t=function(n,t){var r,a=[];for(r in n){var o=n[r];a.push(e(r,o,t))}return a},e=function(t,e,a){var o,i,u=t.split(","),d=[],s=!0;for(d.data=[],d.startingNodes=[],d.responder=e,i=0;u.length>i;i++)o=n(u[i]),d.data[i]={},o.length>=3&&"["===o.charAt(0)&&"]"===o.charAt(o.length-1)?(o=o.substring(1,o.length-1),d.data[i].optional=!0):d.data[i].optional=!1,"!"===o.charAt(0)?(o=o.substring(1,o.length),d.data[i].negator=!0):d.data[i].negator=!1,d.data[i].index=i,d.data[i].matcher=r.findByName(o,a),d.data[i].linksTo=[],d.data[i].isStartingNode=s,s&&d.startingNodes.push(d.data[i]),s&&d.data[i].optional||(s=!1);for(i=0;d.data.length-1>i;i++){for(var f=!0,c=i+1;d.data.length>c;c++)if(d.data[i].linksTo.push(d.data[c]),!d.data[c].optional){f=!1;break}d.data[i].isEndNode=f}return d.data[i].isEndNode=!0,console.log("$$$$$ PARSED EXPRESSION IS NOW A TREE $$$$$"),console.log(d),d};return t}(),r=function(){var n=function(n,r){var e;return"object"==typeof r&&(e=r[n]),e||(e=t[n]),e},t={"true":function(n){return n===!0},"false":function(n){return n===!1},truthy:function(n){return n?!0:!1},falsy:function(n){return n?!1:!0},object:function(n){return"object"==typeof n},number:function(n){return"number"==typeof n},string:function(n){return"string"==typeof n},any:function(n){return n!==void 0&&null!==n},"function":function(n){return"function"==typeof n}};return t["*"]=t.any,t.falsey=t.falsy,{findByName:n}}(),e=function(){var n,t,r,e,a,o,i=[],u=function(n){r[n.index]||(r[n.index]=0);var a=n.matcher(e[t]);return n.negator&&(a=!a),a?d(n):s(n)},d=function(a){i[a.index]=e[t];var o=r[a.index],d=a.linksTo[o];return t++,n.push(d),a.isEndNode&&t===e.length?i:d?(r[d.index]=0,u(d)):t===e.length?i:!1},s=function(e){n.pop(),i[e.index]=void 0;var d=n[n.length-1];if(!d){o++;var f=a[o];return void 0!==f?u(f):!1}r[d.index]+=1;var c=d.linksTo[r[d.index]];return c?(r[c.index]=0,n.push(c),u(c)):(t--,s(d))},f=function(d,s){return e=s,t=0,r=[],i=[],a=d.startingNodes,o=0,n=[a[0]],u(a[0])};return f}(),a=function(){},o=function(n,t){var r,o,i,u;for(u=0;t.length>u&&(i=t[u],r=i.responder,o=e(i,n),"object"!=typeof o);u++)o=[],r=a;return{responder:r,args:o}},i=function(n){var r=t(n.responders,n.matchers),e=function(){var n=o(arguments,r);return n.responder.apply(this,n.args)};return e},u=this;n="undefined"!=typeof exports?exports:u.signature={},n.createHandler=i})();