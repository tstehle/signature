/*! signature 2013-04-19 */
(function(){var n,t=function(){var n=function(n){return n.replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,"").replace(/\s+/g," ")},t=function(n,t){var r,e=[];for(r in n){var i=n[r];e.push(a(r,i,t))}return e},a=function(t,a,e){var i,o,u=t.split(","),d=[],s=!0;for(d.data=[],d.startingNodes=[],d.responder=a,o=0;u.length>o;o++){if(i=n(u[o]),""===i)return d.hasEmptyPath=!0,d;d.data[o]={},i.length>=3&&"["===i.charAt(0)&&"]"===i.charAt(i.length-1)?(i=i.substring(1,i.length-1),d.data[o].optional=!0):d.data[o].optional=!1,"!"===i.charAt(0)?(i=i.substring(1,i.length),d.data[o].negator=!0):d.data[o].negator=!1,d.data[o].index=o,d.data[o].matcher=r.findByName(i,e),d.data[o].linksTo=[],d.data[o].isStartingNode=s,s&&d.startingNodes.push(d.data[o]),s&&d.data[o].optional||(s=!1)}for(o=0;d.data.length-1>o;o++){for(var f=!0,c=o+1;d.data.length>c;c++)if(d.data[o].linksTo.push(d.data[c]),!d.data[c].optional){f=!1;break}d.data[o].isEndNode=f}return d.data[o].isEndNode=!0,d.data[0].isEndNode&&d.data[0].isStartingNode&&d.data[0].optional&&(d.hasEmptyPath=!0),d};return t}(),r=function(){var n=function(n,r){var a;return"object"==typeof r&&(a=r[n]),a||(a=t[n]),a},t={"true":function(n){return n===!0},"false":function(n){return n===!1},truthy:function(n){return n?!0:!1},falsy:function(n){return n?!1:!0},object:function(n){return"object"==typeof n},number:function(n){return"number"==typeof n},string:function(n){return"string"==typeof n},any:function(n){return n!==void 0&&null!==n},"function":function(n){return"function"==typeof n}};return t["*"]=t.any,t.falsey=t.falsy,{findByName:n}}(),a=function(){var n,t,r,a,e,i,o=[],u=function(n){var e=n.matcher(a[t]);return n.negator&&(e=!e),e?(r[n.index]||(r[n.index]=0),d(n)):s(n)},d=function(e){o[e.index]=a[t];var i=r[e.index],d=e.linksTo[i];return t++,n.push(d),e.isEndNode&&t===a.length?o:d?(r[d.index]=0,u(d)):t===a.length?o:!1},s=function(a){n.pop(),o[a.index]=void 0;var d=n[n.length-1];if(!d){i++;var f=e[i];return void 0!==f?u(f):!1}r[d.index]+=1;var c=d.linksTo[r[d.index]];return c?(r[c.index]=0,n.push(c),u(c)):(t--,s(d))},f=function(d,s){return a=s,t=0,r=[],o=[],e=d.startingNodes,i=0,n=[e[0]],0===s.length&&d.hasEmptyPath?[]:u(e[0])};return f}(),e=function(n){var r=t(n.responders,n.matchers),e=function(){var n,t,e,i;for(i=0;r.length>i;i++)if(e=r[i],t=a(e,arguments),t!==!1)return n=e.responder,n.apply(this,t);return void 0};return e},i=this;n="undefined"!=typeof exports?exports:i.signature={},n.createHandler=e})();