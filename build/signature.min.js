/*! signature 2013-04-17 */
(function(){var n,t=function(){var n=function(n){return n.replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,"").replace(/\s+/g," ")},t=function(n,t){var e,o=[];for(e in n){var a=n[e];o.push(r(e,a,t))}return o},r=function(t,r,o){var a,i,u=t.split(","),d=[],s=!0;for(d.data=[],d.startingNodes=[],d.responder=r,i=0;u.length>i;i++){if(a=n(u[i]),""===a)return d.hasEmptyPath=!0,d;d.data[i]={},a.length>=3&&"["===a.charAt(0)&&"]"===a.charAt(a.length-1)?(a=a.substring(1,a.length-1),d.data[i].optional=!0):d.data[i].optional=!1,"!"===a.charAt(0)?(a=a.substring(1,a.length),d.data[i].negator=!0):d.data[i].negator=!1,d.data[i].index=i,d.data[i].matcher=e.findByName(a,o),d.data[i].linksTo=[],d.data[i].isStartingNode=s,s&&d.startingNodes.push(d.data[i]),s&&d.data[i].optional||(s=!1)}for(i=0;d.data.length-1>i;i++){for(var f=!0,l=i+1;d.data.length>l;l++)if(d.data[i].linksTo.push(d.data[l]),!d.data[l].optional){f=!1;break}d.data[i].isEndNode=f}return d.data[i].isEndNode=!0,d.data[0].isEndNode&&d.data[0].isStartingNode&&d.data[0].optional&&(d.hasEmptyPath=!0),console.log("$$$$$ PARSED EXPRESSION IS NOW A TREE $$$$$"),console.log(d),d};return t}(),e=function(){var n=function(n,e){var r;return"object"==typeof e&&(r=e[n]),r||(r=t[n]),r},t={"true":function(n){return n===!0},"false":function(n){return n===!1},truthy:function(n){return n?!0:!1},falsy:function(n){return n?!1:!0},object:function(n){return"object"==typeof n},number:function(n){return"number"==typeof n},string:function(n){return"string"==typeof n},any:function(n){return n!==void 0&&null!==n},"function":function(n){return"function"==typeof n}};return t["*"]=t.any,t.falsey=t.falsy,{findByName:n}}(),r=function(){var n,t,e,r,o,a,i=[],u=function(n){var o=n.matcher(r[t]);return n.negator&&(o=!o),o?(e[n.index]||(e[n.index]=0),console.log("doParse of node "+n.index+" compared to argument "+r[t]+" --- PASS"),d(n)):(console.log("doParse of node "+n.index+" compared to argument "+r[t]+" --- FAIL"),s(n))},d=function(o){i[o.index]=r[t];var a=e[o.index],d=o.linksTo[a];return t++,n.push(d),o.isEndNode&&t===r.length?i:d?(e[d.index]=0,u(d)):t===r.length?i:!1},s=function(r){n.pop(),i[r.index]=void 0;var d=n[n.length-1];if(console.log("*/*/*/ BACKTRACKING TO PREVIOUS NODE:"),console.log(d),!d){a++;var f=o[a];return void 0!==f?u(f):!1}e[d.index]+=1;var l=d.linksTo[e[d.index]];return l?(e[l.index]=0,n.push(l),console.log("*/*/*/ FINDING NEXT NODE:"),console.log(l),u(l)):(t--,s(d))},f=function(d,s){return r=s,t=0,e=[],i=[],o=d.startingNodes,a=0,n=[o[0]],0===s.length&&d.hasEmptyPath?[]:u(o[0])};return f}(),o=function(n){var e=t(n.responders,n.matchers),o=function(){var n,t,o,a;for(a=0;e.length>a;a++)if(o=e[a],t=r(o,arguments),t!==!1)return n=o.responder,n.apply(this,t);return void 0};return o},a=this;n="undefined"!=typeof exports?exports:a.signature={},n.createHandler=o})();